(function(t){function e(e){for(var a,l,o=e[0],d=e[1],u=e[2],s=0,b=[];s<o.length;s++)l=o[s],Object.prototype.hasOwnProperty.call(c,l)&&c[l]&&b.push(c[l][0]),c[l]=0;for(a in d)Object.prototype.hasOwnProperty.call(d,a)&&(t[a]=d[a]);r&&r(e);while(b.length)b.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,o=1;o<n.length;o++){var d=n[o];0!==c[d]&&(a=!1)}a&&(i.splice(e--,1),t=l(l.s=n[0]))}return t}var a={},c={app:0},i=[];function l(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=t,l.c=a,l.d=function(t,e,n){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)l.d(n,a,function(e){return t[e]}.bind(null,a));return n},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="/smeta/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],d=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var r=d;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"2a10":function(t,e,n){"use strict";n("de92")},"31cd":function(t,e,n){},"48bb":function(t,e,n){"use strict";n("bc0b")},"50d1":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("7a23"),c=(n("b0c0"),{class:"main"}),i={class:"mainControls"},l=Object(a["f"])("Страница: "),o=Object(a["g"])("th",null,"Наименование",-1),d=Object(a["g"])("th",null,"Кол-во",-1),u=Object(a["g"])("th",null,"Цена на ед. изм.",-1),r=Object(a["g"])("th",null,"Цена",-1),s={key:0},b={key:0},g={key:1},j={key:2},O={key:3},p={key:4},f={key:5},h={key:6},v={class:"controls"},m={class:"totalCost"},k=Object(a["g"])("td",null,"Общая цена",-1),y=Object(a["g"])("td",null,null,-1),w=Object(a["g"])("td",null,null,-1),P={key:0},C={key:0,class:"overlay"},E={key:0,class:"overlay"};function D(t,e,n,D,S,A){var W=Object(a["o"])("add-window"),N=Object(a["o"])("add-page-window");return Object(a["i"])(),Object(a["d"])("div",c,[Object(a["g"])("div",i,[Object(a["g"])("div",null,[Object(a["g"])("label",null,[l,Object(a["t"])(Object(a["g"])("select",{"onUpdate:modelValue":e[1]||(e[1]=function(t){return D.currentPage=t}),onChange:e[2]||(e[2]=function(){return A.updatePage&&A.updatePage.apply(A,arguments)})},[(Object(a["i"])(!0),Object(a["d"])(a["a"],null,Object(a["m"])(A.pageNames(),(function(t){return Object(a["i"])(),Object(a["d"])("option",{value:t,key:t},Object(a["p"])(t),9,["value"])})),128))],544),[[a["r"],D.currentPage]])]),Object(a["g"])("button",{onClick:e[3]||(e[3]=function(e){return t.showAddWindow=!0}),class:"add"},"Добавить запись")]),Object(a["g"])("div",null,[Object(a["g"])("button",{onClick:e[4]||(e[4]=function(e){return t.showAddPageWindow=!0})},"Добавить страницу"),Object(a["g"])("button",{onClick:e[5]||(e[5]=function(){return A.editPage&&A.editPage.apply(A,arguments)})},"Изменить текущую страницу"),Object(a["g"])("button",{onClick:e[6]||(e[6]=function(){return A.deletePage&&A.deletePage.apply(A,arguments)})},"Удалить текущую страницу")]),Object(a["g"])("div",null,[Object(a["g"])("button",{onClick:e[7]||(e[7]=function(){return D.screenshot&&D.screenshot.apply(D,arguments)})},"Снимок текущей страницы")])]),Object(a["g"])("table",null,[Object(a["g"])("tr",null,[o,d,u,r,D.isScreenshotting?Object(a["e"])("",!0):(Object(a["i"])(),Object(a["d"])("th",s,"Управление"))]),(Object(a["i"])(!0),Object(a["d"])(a["a"],null,Object(a["m"])(D.data[D.currentPage],(function(t){return Object(a["i"])(),Object(a["d"])("tr",{key:t.name},[Object(a["g"])("td",null,Object(a["p"])(t.name),1),t.cost?(Object(a["i"])(),Object(a["d"])("td",g)):(Object(a["i"])(),Object(a["d"])("td",b,Object(a["p"])(t.count)+" "+Object(a["p"])(t.units),1)),t.cost?(Object(a["i"])(),Object(a["d"])("td",O)):(Object(a["i"])(),Object(a["d"])("td",j,Object(a["p"])(t.costPU)+" руб.",1)),t.cost?(Object(a["i"])(),Object(a["d"])("td",f,Object(a["p"])(t.cost)+" руб.",1)):(Object(a["i"])(),Object(a["d"])("td",p,Object(a["p"])(Math.round(t.count*t.costPU*1e3)/1e3)+" руб. ",1)),D.isScreenshotting?Object(a["e"])("",!0):(Object(a["i"])(),Object(a["d"])("td",h,[Object(a["g"])("div",v,[Object(a["g"])("button",{onClick:function(e){return A.editItem(t.name)}},"🖉",8,["onClick"]),Object(a["g"])("button",{onClick:function(e){return A.deleteItem(t.name)},class:"delete"},"✖",8,["onClick"])])]))])})),128)),Object(a["g"])("tr",m,[k,y,w,Object(a["g"])("td",null,Object(a["p"])(A.totalCost())+" руб.",1),D.isScreenshotting?Object(a["e"])("",!0):(Object(a["i"])(),Object(a["d"])("td",P))])]),Object(a["g"])(a["b"],{name:"fade"},{default:Object(a["s"])((function(){return[t.showAddWindow?(Object(a["i"])(),Object(a["d"])("div",C,[Object(a["g"])(W,{addCallback:A.addNewItem,isEditing:t.isEditing,editingData:t.editingData,editCallback:A.editItem,cancelCallback:A.cancelCallback},null,8,["addCallback","isEditing","editingData","editCallback","cancelCallback"])])):Object(a["e"])("",!0)]})),_:1}),Object(a["g"])(a["b"],{name:"fade"},{default:Object(a["s"])((function(){return[t.showAddPageWindow?(Object(a["i"])(),Object(a["d"])("div",E,[Object(a["g"])(N,{addCallback:A.addNewPage,isEditing:t.isEditingPage,editingData:t.pageEditingData,editCallback:A.editPage,cancelCallback:A.cancelCallback},null,8,["addCallback","isEditing","editingData","editCallback","cancelCallback"])])):Object(a["e"])("",!0)]})),_:1})])}n("b64b"),n("c740"),n("a434");var S=Object(a["v"])("data-v-12bbc17f");Object(a["k"])("data-v-12bbc17f");var A=Object(a["g"])("label",{for:"name"},"Наименование: ",-1),W=Object(a["g"])("label",{for:"customCost"},"Нестандартный предмет",-1),N={key:0},_=Object(a["g"])("label",{for:"area"},"Кол-во + Ед. Измерения: ",-1),x={key:1},U=Object(a["g"])("label",{for:"costPMSQ"},"Цена на ед. изм.: ",-1),I={key:2},F=Object(a["g"])("label",{for:"cost"},"Цена: ",-1),q={class:"controls"};Object(a["j"])();var M=S((function(t,e,n,c,i,l){var o=Object(a["o"])("window");return Object(a["i"])(),Object(a["d"])(o,{title:n.isEditing?"Изменить запись":"Добавить запись"},{default:S((function(){return[Object(a["g"])("form",null,[Object(a["g"])("ul",null,[Object(a["g"])("li",null,[A,Object(a["g"])("input",{type:"text",name:"name",placeholder:"Например, Штукатурка",value:n.isEditing?n.editingData.name:null,required:""},null,8,["value"])]),Object(a["g"])("li",null,[Object(a["t"])(Object(a["g"])("input",{type:"checkbox",name:"customCost","onUpdate:modelValue":e[1]||(e[1]=function(t){return c.customCost=t})},null,512),[[a["q"],c.customCost]]),W]),c.customCost?Object(a["e"])("",!0):(Object(a["i"])(),Object(a["d"])("li",N,[_,Object(a["g"])("input",{type:"text",name:"count",placeholder:"Например, 2.5 м2",value:n.isEditing?n.editingData.count:null,required:""},null,8,["value"])])),c.customCost?Object(a["e"])("",!0):(Object(a["i"])(),Object(a["d"])("li",x,[U,Object(a["g"])("input",{type:"text",name:"costPU",placeholder:"Например, 10",value:n.isEditing?n.editingData.costPMSQ:null,required:""},null,8,["value"])])),c.customCost?(Object(a["i"])(),Object(a["d"])("li",I,[F,Object(a["g"])("input",{type:"text",name:"cost",placeholder:"Например, 75",value:n.isEditing?n.editingData.cost:null,required:""},null,8,["value"])])):Object(a["e"])("",!0),Object(a["g"])("li",q,[Object(a["g"])("input",{type:"button",value:n.isEditing?"Изменить":"Добавить",onClick:e[2]||(e[2]=Object(a["u"])((function(t){return c.parse()}),["prevent"]))},null,8,["value"]),Object(a["g"])("input",{type:"button",value:"Отмена",onClick:e[3]||(e[3]=Object(a["u"])((function(){return n.cancelCallback&&n.cancelCallback.apply(n,arguments)}),["prevent"]))})])])])]})),_:1},8,["title"])})),B=(n("ac1f"),n("1276"),n("99af"),n("a15b"),n("159b"),Object(a["v"])("data-v-eddd706e")),$=B((function(t,e,n,c,i,l){return Object(a["i"])(),Object(a["d"])("div",null,[Object(a["g"])("h2",null,Object(a["p"])(n.title),1),Object(a["n"])(t.$slots,"default",{},void 0,!0)])})),L={name:"Window",props:{title:String}};n("ca68");L.render=$,L.__scopeId="data-v-eddd706e";var J=L,Q={components:{Window:J},name:"AddWindow",props:{addCallback:Function,isEditing:Boolean,editingData:Object,editCallback:Function,cancelCallback:Function},setup:function(t){var e=Object(a["l"])(!1);function n(){var n=document.getElementsByName("name")[0].value;if(e.value)var a=parseFloat(document.getElementsByName("cost")[0].value);else var c=document.getElementsByName("count")[0].value,i=parseFloat(document.getElementsByName("costPU")[0].value);var l,o=!0,d=[];if(0===n.length&&(o=!1,d.push("Наименование")),e.value)isNaN(a)&&(o=!1,d.push("Цена"));else{var u=c.split(" ");isNaN(parseFloat(u[0]))&&(o=!1,d.push("Кол-во + Ед. Измерения")),isNaN(i)&&(o=!1,d.push("Цена на ед. изм."))}o?(l=e.value?{name:n,cost:a}:{name:n,count:parseFloat(u[0]),units:u[1],costPU:i},t.isEditing?t.editCallback(t.editingData.name,l):t.addCallback(l)):alert("Проверьте написание пол".concat(1===d.length?"я":"ей"," ").concat(d.join(", "),"."))}return null!==t.editingData&&t.editingData.cost&&(e.value=!0),{customCost:e,parse:n}},mounted:function(){var t=this;document.querySelectorAll("form input").forEach((function(e){e.addEventListener("keydown",(function(e){"Enter"===e.key&&(e.preventDefault(),t.parse())}))}))}};n("2a10");Q.render=M,Q.__scopeId="data-v-12bbc17f";var T=Q,V=Object(a["v"])("data-v-6b27e012");Object(a["k"])("data-v-6b27e012");var R=Object(a["f"])(" Название: "),z={class:"controls"};Object(a["j"])();var G=V((function(t,e,n,c,i,l){var o=Object(a["o"])("window");return Object(a["i"])(),Object(a["d"])(o,{title:n.isEditing?"Изменить страницу":"Добавить страницу"},{default:V((function(){return[Object(a["g"])("form",null,[Object(a["g"])("ul",null,[Object(a["g"])("li",null,[Object(a["g"])("label",null,[R,Object(a["g"])("input",{type:"text",required:"",name:"name",value:n.isEditing?n.editingData.name:null},null,8,["value"])])]),Object(a["g"])("li",z,[Object(a["g"])("input",{type:"button",value:n.isEditing?"Изменить":"Добавить",onClick:e[1]||(e[1]=Object(a["u"])((function(){return l.parse&&l.parse.apply(l,arguments)}),["prevent"]))},null,8,["value"]),Object(a["g"])("input",{type:"button",value:"Отмена",onClick:e[2]||(e[2]=Object(a["u"])((function(){return n.cancelCallback&&n.cancelCallback.apply(n,arguments)}),["prevent"]))})])])])]})),_:1},8,["title"])})),H={name:"AddPageWindow",components:{Window:J},props:{addCallback:Function,isEditing:Boolean,editingData:Object,editCallback:Function,cancelCallback:Function},methods:{parse:function(){var t=document.getElementsByName("name")[0].value,e=!0,n=[];0===t.length&&(e=!1,n.push("Наименование")),e?this.isEditing?this.editCallback(this.editingData.name,{name:t}):this.addCallback({name:t}):alert("Проверьте написание пол".concat(1===n.length?"я":"ей"," ").concat(n.join(", "),"."))}},mounted:function(){var t=this;document.querySelectorAll("form input").forEach((function(e){e.addEventListener("keydown",(function(e){"Enter"===e.key&&(e.preventDefault(),t.parse())}))}))}};n("48bb");H.render=G,H.__scopeId="data-v-6b27e012";var K=H,X=n("c0e9"),Y=n.n(X),Z=n("aeb1"),tt=n.n(Z),et={components:{AddWindow:T,AddPageWindow:K},name:"App",data:function(){return{showAddWindow:!1,isEditing:!1,editingData:null,showAddPageWindow:!1,isEditingPage:!1,pageEditingData:null}},setup:function(){var t,e=Object(a["l"])(!1);t=void 0!==localStorage.data&&1==localStorage.version?JSON.parse(localStorage.data):{"Стандартная страница":[]};var n=Object(a["l"])(Object.keys(t)[0]);function c(){localStorage.data=JSON.stringify(t),1!==localStorage.version&&(localStorage.version=1)}function i(){e.value=!0,Object(a["h"])().then((function(){Y()(document.querySelector("table")).then((function(t){tt()(t.toDataURL(),n.value),e.value=!1}))}))}return window.addEventListener("beforeunload",c),window.addEventListener("keydown",(function(t){"F2"===t.key&&(t.preventDefault(),i())})),{data:t,save:c,isScreenshotting:e,currentPage:n,screenshot:i}},methods:{addNewItem:function(t){this.data[this.currentPage].push(t),this.showAddWindow=!1,this.$forceUpdate(),this.save()},addNewPage:function(t){Object.defineProperty(this.data,t.name,{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.$forceUpdate(),this.save(),this.showAddPageWindow=!1},editItem:function(t,e){var n=this.data[this.currentPage].findIndex((function(e){return e.name===t}));e?(this.data[this.currentPage][n]=e,this.isEditing=!1,this.editingData=null,this.showAddWindow=!1,this.$forceUpdate()):(this.editingData=this.data[this.currentPage][n],this.isEditing=!0,this.showAddWindow=!0)},editPage:function(t,e){if(e){Object.defineProperty(this.data,e.name,{enumerable:!0,configurable:!0,writable:!0,value:this.data[this.currentPage]});var n=this.currentPage;this.currentPage=e.name,delete this.data[n],this.showAddPageWindow=!1,this.$forceUpdate()}else this.isEditingPage=!0,this.pageEditingData={name:this.currentPage},this.showAddPageWindow=!0},deleteItem:function(t){if(window.confirm("Вы действительно хотите удалить эту запись?")){var e=this.data[this.currentPage].findIndex((function(e){return e.name===t}));this.data[this.currentPage].splice(e,1),this.$forceUpdate()}},deletePage:function(){window.confirm("Вы действительно хотите удалить текущую страницу ("+this.currentPage+")?")&&(delete this.data[this.currentPage],this.currentPage=Object.keys(this.data)[0])},updatePage:function(){},cancelCallback:function(){this.isEditing=!1,this.editingData=null,this.showAddWindow=!1,this.isEditingPage=!1,this.pageEditingData=null,this.showAddPageWindow=!1},totalCost:function(){var t=0;for(var e in this.data[this.currentPage]){var n=this.data[this.currentPage][e];n.cost?t+=n.cost:t+=n.count*n.costPU}return Math.round(1e3*t)/1e3},pageNames:function(){return Object.keys(this.data)}}};n("efff");et.render=D;var nt=et;document.title="Смета",Object(a["c"])(nt).mount("#app")},bc0b:function(t,e,n){},ca68:function(t,e,n){"use strict";n("50d1")},de92:function(t,e,n){},efff:function(t,e,n){"use strict";n("31cd")}});
//# sourceMappingURL=app.62c5406b.js.map